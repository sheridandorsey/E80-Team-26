<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>E80 SP24 - Lab 3 Submission Sheet</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">E80 SP24</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectures/"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs">    
        <li>
    <a class="dropdown-item" href="../../labs/lab_overview">
 <span class="dropdown-text">Lab Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab0">
 <span class="dropdown-text">Lab 0: Tutorial &amp; Skills Review</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab1">
 <span class="dropdown-text">Lab 1: Go Autonomous</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab2">
 <span class="dropdown-text">Lab 2: BEM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab3">
 <span class="dropdown-text">Lab 3: Op-Amps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab4">
 <span class="dropdown-text">Lab 4: Temperature</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab5">
 <span class="dropdown-text">Lab 5: Acoustics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab6">
 <span class="dropdown-text">Lab 6: Fluids</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab7">
 <span class="dropdown-text">Lab 7: Navigation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../project/"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../reference/"> 
<span class="menu-text">Reference Designs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../history/"> 
<span class="menu-text">History</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HMC-E80/E80"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="submission.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 3 Submission Sheet</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Keep answers as short as possible while still meeting specifications. Submit as a PDF.</p>
<p>Team Number:</p>
<p>Team Member Names:</p>
<p>Several of the deliverables in this submission sheet will call for schematics, oscilloscope traces or circuit pictures. These are specific genres of technical documents, so they have conventions you need to adhere to. The specifications for all schematics, oscilloscope traces and circuit pictures are listed on this page instead of being repeated for each deliverable in the document.</p>
<p>All schematics in this report should adhere the following specification:</p>
<ul class="task-list">
<li><label><input type="checkbox">Include the stimulus for the circuit on the left</label></li>
<li><label><input type="checkbox">Include power supply connections and bypass capacitors.</label></li>
<li><label><input type="checkbox">Annotate each node with a name, using the name Vin for the input voltage and Vout for the measured output voltage</label></li>
<li><label><input type="checkbox">Annotate each resistor and capacitor with a component value.</label></li>
<li><label><input type="checkbox">Use implicit connections to connect the power supplies.</label></li>
<li><label><input type="checkbox">Use the op-amp symbol to indicate operational amplifiers (instead of, e.g., a pinout diagram), but annotates that symbol with the chip used to make the op-amp.</label></li>
<li><label><input type="checkbox">Represent op-amp circuits in their typical configurations, so that they look similar to videos. Don’t use non-typical drawings that make one type of op-amp circuit look like another. (e.g.: don’t draw a non-inverting amplifier with feedback on the top of the op-amp; that’s usually how inverting amplifiers are drawn.)</label></li>
<li><label><input type="checkbox">Generally keep signal flow left-to-right</label></li>
<li><label><input type="checkbox">Generally keep high voltages at the top of the diagram and low voltages at the bottom.</label></li>
<li><label><input type="checkbox">Space out components well enough and zoom in close enough that annotations are easy to read.</label></li>
<li><label><input type="checkbox">Minimize unnecessary crossings, corners and jogs in the wires. Use connect-by-name to reduce congestion among wires. This <a href="https://learn.sparkfun.com/tutorials/how-to-read-a-schematic/reading-schematics">tutorial</a> has more information.</label></li>
</ul>
<p>All oscilloscope traces in this report should adhere to the following specification:</p>
<ul class="task-list">
<li><label><input type="checkbox">Show each of the requested quantities on a separate oscilloscope channel.</label></li>
<li><label><input type="checkbox">Scale the horizontal axis so 3-10 cycles of the input/output voltage waves are visible</label></li>
<li><label><input type="checkbox">Scale the vertical axis to maximize size of the input/output waves without clipping</label></li>
<li><label><input type="checkbox">Make sure the input/output waves use the same 0 V reference voltage.</label></li>
<li><label><input type="checkbox">Be exported using the screen capture function of the oscilloscope. Phone pictures of oscilloscope data are unacceptable. (Note that in a normal lab setting it would be essential to also capture CSV output from the oscilloscope for later mathematical processing. No need to do that in this lab, screen captures are fine.)</label></li>
</ul>
<p>All pictures of circuits in this report should adhere to the following specification:</p>
<ul class="task-list">
<li><label><input type="checkbox">Picture is taken at a level of lighting and zoom that allows a reader to trace connections in the circuit.</label></li>
<li><label><input type="checkbox">The circuit is neatly laid out so that readers can trace connections in the circuit.</label></li>
</ul>
<div style="page-break-after: always;"></div>
<section id="report-on-the-design-and-characterization-of-a-non-inverting-amplifier" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-design-and-characterization-of-a-non-inverting-amplifier">Report on the Design and Characterization of a Non-Inverting Amplifier</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the non-inverting amplifier</label></li>
<li><label><input type="checkbox">Provides a schematic of the non-inverting amplifier and stimulus</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides an oscilloscope trace of the input and the output for the following input: 100 mV amplitude sine wave with a 1 V offset.</label></li>
<li><label><input type="checkbox">Provides an oscilloscope trace of the input and the output for the following input: 100 mV amplitude sine wave with a 0 V offset.</label></li>
<li><label><input type="checkbox">Traces show correct behavior, matching designed gain and highlighting appropriate non-idealities</label></li>
<li><label><input type="checkbox">Correctly, in 1-2 sentences, describes why the output signal in the 0 V offset trace does not fully obey the equation that describes non-inverting amplifier outputs.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="report-on-the-design-and-characterization-of-an-offset-amplifier" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-design-and-characterization-of-an-offset-amplifier">Report on the Design and Characterization of an Offset Amplifier</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the offset amplifier</label></li>
<li><label><input type="checkbox">Provides a schematic of the offset amplifier</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Describes the design process for the offset amplifier: specifies the intended gain and offset, provides equation describing offset amplifier output Voltage, manipulates that equation (and states necessary assumptions) to find resistor values and showing the appropriate equation and hand calculations to find the for offset amplifier output Voltage.</label></li>
<li><label><input type="checkbox">Provides an oscilloscope trace of the input and the output for the following input: 100 mV amplitude sine wave with a 0 V offset.</label></li>
<li><label><input type="checkbox">The output trace shows a complete sine wave with no op-amp introduced non-idealities.</label></li>
<li><label><input type="checkbox">The op-amp trace behaves as predicted in the hand design.</label></li>
<li><label><input type="checkbox">1-2 sentences of discussion of why this design performs differently than a non-inverting amplifier for the same input.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="report-on-the-design-and-characterization-of-a-555-timer-led-driver" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-design-and-characterization-of-a-555-timer-led-driver">Report on the Design and Characterization of a 555 Timer LED Driver</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the 555 timer LED driver.</label></li>
<li><label><input type="checkbox">Provides a schematic of the 555 timer LED driver.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides an oscilloscope trace of the output, 555 capacitor node, and Voltage in the middle of the diode-resistor string.</label></li>
<li><label><input type="checkbox">Trace indicates 500 Hz - 1 kHz operating frequency and ~60% duty cycle.</label></li>
<li><label><input type="checkbox">Resistor value in schematic and resistor voltage measurement indicate diode is receiving 20-40 mA of current.</label></li>
<li><label><input type="checkbox">Includes design process for 555 timer: lists target frequency and duty cycle, and shows how resistors and capacitors were selected to hit that target.</label></li>
<li><label><input type="checkbox">Includes calculations showing how resistor was selected to limit current in IR1503.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="report-on-the-design-and-characterization-of-a-transimpedance-amplifier" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-design-and-characterization-of-a-transimpedance-amplifier">Report on the Design and Characterization of a Transimpedance Amplifier</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the transimpedance amplifier including the IR LED illuminating the photodiode</label></li>
<li><label><input type="checkbox">Provides a schematic of the transimpedance amplifier</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Includes analysis of transimpedance amplifier circuit, showing relation between VOUT, ID and RF.</label></li>
<li><label><input type="checkbox">Provides an oscilloscope trace of 555 timer output and transimpedance amplifier output when transimpedance photodiode is illuminated by the IR LED.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="report-on-the-design-and-characterization-of-a-turbidity-meter" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-design-and-characterization-of-a-turbidity-meter">Report on the Design and Characterization of a Turbidity Meter</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the prepared solutions in cuvettes. Picture is annotated to indicate turbidity of each cuvette.</label></li>
<li><label><input type="checkbox">Provides a picture of the assembled turbidity meter.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides two sets of oscilloscope traces showing 555 timer output, 90° transimpedance amplifier output and transmission transimpedance amplifier output.</label>
<ul>
<li>The traces are gathered while a solution of middling turbidity is in the turbidity meter, so both 90° and transmission outputs are visible.</li>
<li>The first set of traces are gathered under normal lighting conditions.</li>
<li>The second set of traces are gathered under shadowed lighting conditions.</li>
</ul></li>
<li><label><input type="checkbox">Plot of Vpp,90/Vpp,Transmission vs.&nbsp;Turbidity values annotated with uncertainty measures.</label></li>
<li><label><input type="checkbox">Plotted turbidity data shows a linear relationship so measured Voltages can be used to predict turbidity.</label></li>
<li><label><input type="checkbox">2-3 sentences explaining why we use a switching LED, why we measure peak-peak Voltages in the transimpedance outputs, and why those decisions are related to ambient light.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="extra-credit-writeups" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit-writeups">Extra Credit Writeups:</h2>
<p>We don’t provide complete specifications for extra credit writeups, but they will be graded for effort and completeness like normal sections. You need to provide a “mini-report” of &lt;1 page for each extra credit section that you attempt. Put a page break between each extra credit mini-report.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>