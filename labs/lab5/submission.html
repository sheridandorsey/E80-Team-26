<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>E80 SP24 - Lab 5 Submission Sheet</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">E80 SP24</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectures/"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-labs">    
        <li>
    <a class="dropdown-item" href="../../labs/lab_overview">
 <span class="dropdown-text">Lab Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab0">
 <span class="dropdown-text">Lab 0: Tutorial &amp; Skills Review</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab1">
 <span class="dropdown-text">Lab 1: Go Autonomous</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab2">
 <span class="dropdown-text">Lab 2: BEM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab3">
 <span class="dropdown-text">Lab 3: Op-Amps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab4">
 <span class="dropdown-text">Lab 4: Temperature</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab5">
 <span class="dropdown-text">Lab 5: Acoustics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab6">
 <span class="dropdown-text">Lab 6: Fluids</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs/lab7">
 <span class="dropdown-text">Lab 7: Navigation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../project/"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../reference/"> 
<span class="menu-text">Reference Designs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../history/"> 
<span class="menu-text">History</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HMC-E80/E80"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="submission.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 5 Submission Sheet</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Keep answers as short as possible while still meeting specifications. Submit as a PDF.</p>
<p>Team Number:</p>
<p>Team Member Names:</p>
<p>All schematics in this report should adhere the following specification:</p>
<ul class="task-list">
<li><label><input type="checkbox">Include the stimulus for the circuit on the left</label></li>
<li><label><input type="checkbox">Include power supply connections and bypass capacitors.</label></li>
<li><label><input type="checkbox">Annotate each node with a name, using the name Vin for the input voltage and Vout for the measured output voltage</label></li>
<li><label><input type="checkbox">Annotate each resistor and capacitor with a component value.</label></li>
<li><label><input type="checkbox">Use implicit connections to connect the power supplies.</label></li>
<li><label><input type="checkbox">Use the op-amp symbol to indicate operational amplifiers (instead of, e.g., a pinout diagram), but annotates that symbol with the chip used to make the op-amp.</label></li>
<li><label><input type="checkbox">Represent op-amp circuits in their typical configurations, so that they look similar to videos. Don’t use non-typical drawings that make one type of op-amp circuit look like another. (e.g.: don’t draw a non-inverting amplifier with feedback on the top of the op-amp; that’s usually how inverting amplifiers are drawn.)</label></li>
<li><label><input type="checkbox">Generally keep signal flow left-to-right</label></li>
<li><label><input type="checkbox">Generally keep high voltages at the top of the diagram and low voltages at the bottom.</label></li>
<li><label><input type="checkbox">Space out components well enough and zoom in close enough that annotations are easy to read.</label></li>
<li><label><input type="checkbox">Minimize unnecessary crossings, corners and jogs in the wires. Use connect-by-name to reduce congestion among wires. This <a href="https://learn.sparkfun.com/tutorials/how-to-read-a-schematic/reading-schematics">tutorial</a> has more information.</label></li>
</ul>
<p>All pictures of circuits in this report should adhere to the following specification:</p>
<ul class="task-list">
<li><label><input type="checkbox">Picture is taken at a level of lighting and zoom that allows a reader to trace connections in the circuit.</label></li>
<li><label><input type="checkbox">The circuit is neatly laid out so that readers can trace connections in the circuit.</label></li>
</ul>
<div style="page-break-after: always;"></div>
<section id="report-on-the-fft-of-signals-directly-applied-to-the-scope" class="level2">
<h2 class="anchored" data-anchor-id="report-on-the-fft-of-signals-directly-applied-to-the-scope">Report on the FFT of Signals Directly Applied to the Scope</h2>
<p>The manual for this section requests five oscilloscope traces, which will be referred to here as traces 1-5 based on the list below. Traces should follow the instructions in the manual (50 cycles on screen, FFT span is 100 kHz, FFT center is 50 kHz). Further, the input signal should be on channel 1 and the math mode should be scaled to be clearly visible:</p>
<ol type="1">
<li>Signal 1</li>
<li>Signal 2</li>
<li>Signal 3 with rectangular window</li>
<li>Signal 3 with Hanning window</li>
<li>Signal 3 with rectangular window and changed x-axis</li>
</ol>
<p>The manual also requests two Matlab plots</p>
<ol type="1">
<li>Matlab plot of FFT magnitude for signal 3 with rectangular window</li>
<li>Matlab plot of FFT magnitude for signal 3 with Hanning window</li>
</ol>
<p>These traces and plots should be included in this section with a specific organization. They should be displayed as five side-by-side pairs of figures, each with ~1 sentence commenting on the differences between the left and the right figure. The commentary should specifically relate the changes to FFT theory. The pairs are:</p>
<ul class="task-list">
<li><label><input type="checkbox">Trace 1 vs.&nbsp;Trace 2</label></li>
<li><label><input type="checkbox">Trace 1 vs.&nbsp;Trace 3</label></li>
<li><label><input type="checkbox">Trace 3 vs.&nbsp;Trace 4</label></li>
<li><label><input type="checkbox">Trace 4 vs.&nbsp;Trace 5</label></li>
<li><label><input type="checkbox">Trace 3 vs.&nbsp;Matlab Plot 1</label></li>
<li><label><input type="checkbox">Trace 4 vs.&nbsp;Matlab plot 2</label></li>
</ul>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Includes all side-by-side comparisons described in this section.</label></li>
<li><label><input type="checkbox">All plots adhere to instructions in this section and in the manual (50 cycles on screen, FFT span 100 kHz, FFT center is 50 kHz), and all plots are easily legible.</label></li>
<li><label><input type="checkbox">Includes a derivation that explains how frequency peaks in signal 3 relate to the input frequency and the shape of the wave.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">All 1 sentence descriptions correctly relate features in side-by-side comparisons to FFT behavior.</label></li>
<li><label><input type="checkbox">Derivation of frequency peak locations is succinct and correct.</label></li>
<li><label><input type="checkbox">Includes a further 2-3 sentences discussion of windowing functions explaining how they work (by appealing to Fourier analysis) and what the tradeoffs are in choosing one over another.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="report-on-design-and-characterization-of-microphone-interface-circuit" class="level2">
<h2 class="anchored" data-anchor-id="report-on-design-and-characterization-of-microphone-interface-circuit">Report on Design and Characterization of Microphone Interface Circuit</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Provides a picture of the microphone interface circuit, including the microphone.</label></li>
<li><label><input type="checkbox">Provides a schematic of the microphone interface circuit, including the microphone.</label></li>
<li><label><input type="checkbox">Includes some good-faith calculations predicting the bandwidth of each amplifier stage in the interface using the gain-bandwidth product.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Calculations of gain-bandwidth product are correct</label></li>
<li><label><input type="checkbox">Provides an oscilloscope trace of the hand clap with overlaid FFT. The horizontal axis on this trace should be scaled to capture the entire clap, the vertical axis should be scaled so the time domain signal is as large as possible without clipping, the vertical offset should be set to 0V. The FFT span and center should be set to clearly show clap frequencies. Trace must be exported using screen capture, not a cell phone photo.</label></li>
<li><label><input type="checkbox">The clap signal shows proper circuit operation: clap signal is centered at 0V, clap peak amplitude is measured as &gt; 100mV.</label></li>
<li><label><input type="checkbox">Brief discussion of what frequencies are present in the hand clap and how those frequencies compare to the range of human audible frequencies and to the range of typical human speech.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="graphs-of-microphone-voltage-vs.-position-for-beacon-based-localization" class="level2">
<h2 class="anchored" data-anchor-id="graphs-of-microphone-voltage-vs.-position-for-beacon-based-localization">Graphs of Microphone Voltage vs.&nbsp;Position for Beacon-Based Localization</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Makes claims about which beacon emits each frequency, and includes pictures and oscilloscope traces that support the claims.</label></li>
<li><label><input type="checkbox">Include three plots of received Voltage magnitudes vs.&nbsp;distance, one for each emitter. Plots are clearly legible and labeled.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Includes calculations suggesting how frequently multipath patterns will repeat in data and how close to space x-axis samples to capture those patterns.</label></li>
<li><label><input type="checkbox">Plots show multipath effects overlaid onto typical magnitude decay behavior.</label></li>
<li><label><input type="checkbox">Analytical model for received Voltage magnitude is overlaid onto the plots.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="graphs-of-microphone-voltage-sampled-at-different-frequencies-with-teensy-rig" class="level2">
<h2 class="anchored" data-anchor-id="graphs-of-microphone-voltage-sampled-at-different-frequencies-with-teensy-rig">Graphs of Microphone Voltage Sampled at Different Frequencies with Teensy Rig</h2>
<p>Effort:</p>
<ul class="task-list">
<li><label><input type="checkbox">Includes plots of FFT magnitude for 10 kS/s and 100 kS/s data. Plots are legible and labeled so it is clear which is which.</label></li>
<li><label><input type="checkbox">Includes plots of time samples for 10 kS/s and 100 kS/s data. Plots are legible and labeled so it is clear which is which.</label></li>
</ul>
<p>Complete:</p>
<ul class="task-list">
<li><label><input type="checkbox">Explains discrepancies between measured data and data that is being transmitted in the tank using appropriate theory. 4-5 sentences.</label></li>
<li><label><input type="checkbox">Includes calculations of minimum sampling rate for the tank.</label></li>
<li><label><input type="checkbox">Includes plots of time data and FFT magnitude for tank data sampled at the minimum frequency.</label></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="extra-credit-writeups" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit-writeups">Extra Credit Writeups:</h2>
<p>We don’t provide complete specifications for extra credit writeups, but they will be graded for effort and completeness like normal sections. You need to provide a “mini-report” of &lt;1 page for each extra credit section that you attempt. Put a page break between each extra credit mini-report.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>